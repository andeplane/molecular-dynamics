#include <vector>
using std::vector;
#include <UnitTest++.h>
#include <potentials/potentials.h>
#include <includes.h>

void lennardJones(Atom &atom1, Atom &atom2, vector<double> &forceVector, double cutoffDistance) {
    forceVector.resize(3,0);
    forceVector[0] = 0; forceVector[1] = 0; forceVector[2] = 0;
    double dr[3];
    dr[0] = atom1.position[0]-atom2.position[0];
    dr[1] = atom1.position[1]-atom2.position[1];
    dr[2] = atom1.position[2]-atom2.position[2];

    double dr2 = dr[0]*dr[0] + dr[1]*dr[1] + dr[2]*dr[2];
    double cutoffDistanceSquared = cutoffDistance*cutoffDistance;
    if (dr2<cutoffDistanceSquared) {
        double dr2_inverse = 1.0/dr2;
        double dr6_inverse = dr2_inverse*dr2_inverse*dr2_inverse;
        double force = (2*dr6_inverse-1)*dr6_inverse*dr2_inverse*24;
        forceVector[0] = force*dr[0];
        forceVector[1] = force*dr[1];
        forceVector[2] = force*dr[2];
    }
}

void setPositionsAndResetForces(Atom &atom1, Atom &atom2, double r1x, double r1y, double r1z, double r2x, double r2y, double r2z) {
    atom1.resetForce(); atom2.resetForce();
    atom1.setPosition(r1x,r1y,r1z);
    atom2.setPosition(r2x,r2y,r2z);
}

SUITE(Forces) {
    TEST(ArgonForceTest) {
        Atom atom1(AtomType::atomTypeFromAtomType(AtomTypes::Argon));
        Atom atom2(AtomType::atomTypeFromAtomType(AtomTypes::Argon));

        LennardJonesPotential potential;
        potential.setSigma(1.0);
        potential.setEpsilon(1.0);

        atom1.setPosition(0.78432233, -0.112332, 1.22315322);
        potential.twoParticleAction(&atom1,&atom2);
        CHECK_EQUAL(atom1.force[0], -atom2.force[0]);
        CHECK_EQUAL(atom1.force[1], -atom2.force[1]);
        CHECK_EQUAL(atom1.force[2], -atom2.force[2]);
        vector<double> forceVector(3,0);

        setPositionsAndResetForces(atom1,atom2, 1,0,0, 0,0,0);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);

        setPositionsAndResetForces(atom1,atom2, -1,0,0, 0,0,0);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);

        setPositionsAndResetForces(atom1,atom2, 0,1,0, 0,0,0);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);

        setPositionsAndResetForces(atom1,atom2, 0,-1,0, 0,0,0);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);

        setPositionsAndResetForces(atom1,atom2, 0,0,1, 0,0,0);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);

        setPositionsAndResetForces(atom1,atom2, 0,0,1, 0,0,0);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);

        setPositionsAndResetForces(atom1,atom2, 10,10,10, 0,0,0);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);

        setPositionsAndResetForces(atom1,atom2, 10,10,10, 5,4,3);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);

        potential.setCutoffDistance(INFINITY);
        setPositionsAndResetForces(atom1,atom2, -10,-10,10, -5,4,3);
        lennardJones(atom1,atom2,forceVector,potential.cutoffDistance());
        potential.twoParticleAction(&atom1, &atom2);
        CHECK_ARRAY_CLOSE(forceVector,atom1.force,3,1e-10);
    }

    TEST(USCSiO2TwoBody) {
        Atom silicon1(AtomType::atomTypeFromAtomType(AtomTypes::Silicon));
        Atom silicon2(AtomType::atomTypeFromAtomType(AtomTypes::Silicon));
        Atom oxygen1(AtomType::atomTypeFromAtomType(AtomTypes::Oxygen));
        Atom oxygen2(AtomType::atomTypeFromAtomType(AtomTypes::Oxygen));
        vector<Atom*> atoms;
        atoms.push_back(&silicon1);
        atoms.push_back(&silicon2);
        atoms.push_back(&oxygen1);
        atoms.push_back(&oxygen2);

        USCSIO2Potential potential;
        double rMin = 2;
        double rMax = 6;
        int nPoints = 1000;
        double deltaR = (rMax - rMin)/(nPoints - 1);

        vector<double> distances(nPoints);
        vector<double> SiSiForces(nPoints);
        vector<double> SiOForces(nPoints);
        vector<double> OOForces(nPoints);
        for(int i=0; i<nPoints; i++) {
            double x = rMin + i*deltaR;
            distances.at(i) = x;

            // O-O
            for(Atom *atom : atoms) atom->resetForce();
            oxygen2.setPosition(UnitConverter::lengthFromAngstroms(x), 0, 0);
            potential.twoParticleAction(&oxygen1, &oxygen2);
            OOForces.at(i) = oxygen2.force[0];

            // Si-Si
            for(Atom *atom : atoms) atom->resetForce();
            silicon2.setPosition(UnitConverter::lengthFromAngstroms(x), 0, 0);
            potential.twoParticleAction(&silicon1, &silicon2);
            SiSiForces.at(i) = silicon2.force[0];

            // Si-O
            for(Atom *atom : atoms) atom->resetForce();
            oxygen2.setPosition(UnitConverter::lengthFromAngstroms(x), 0, 0);
            potential.twoParticleAction(&silicon1, &oxygen2);
            SiOForces.at(i) = oxygen2.force[0];
        }

//        cout << "r_MD = [";
//        for(int i=0; i<distances.size(); i++) {
//            double r = distances.at(i);
//            if(i==distances.size()-1) cout << r << "];" << endl;
//            else cout << r << ", ";
//        }

//        cout << "F_Si_Si_MD = [";
//        for(int i=0; i<SiSiForces.size(); i++) {
//            double F = SiSiForces.at(i);
//            if(i==SiSiForces.size()-1) cout << F << "];" << endl;
//            else cout << F << ", ";
//        }

//        cout << "F_Si_O_MD = [";
//        for(int i=0; i<SiOForces.size(); i++) {
//            double F = SiOForces.at(i);
//            if(i==SiOForces.size()-1) cout << F << "];" << endl;
//            else cout << F << ", ";
//        }

//        cout << "F_O_O_MD = [";
//        for(int i=0; i<OOForces.size(); i++) {
//            double F = OOForces.at(i);
//            if(i==OOForces.size()-1) cout << F << "];" << endl;
//            else cout << F << ", ";
//        }

        vector<double> rCorrect = {2, 2.004, 2.00801, 2.01201, 2.01602, 2.02002, 2.02402, 2.02803, 2.03203, 2.03604, 2.04004, 2.04404, 2.04805, 2.05205, 2.05606, 2.06006, 2.06406, 2.06807, 2.07207, 2.07608, 2.08008, 2.08408, 2.08809, 2.09209, 2.0961, 2.1001, 2.1041, 2.10811, 2.11211, 2.11612, 2.12012, 2.12412, 2.12813, 2.13213, 2.13614, 2.14014, 2.14414, 2.14815, 2.15215, 2.15616, 2.16016, 2.16416, 2.16817, 2.17217, 2.17618, 2.18018, 2.18418, 2.18819, 2.19219, 2.1962, 2.2002, 2.2042, 2.20821, 2.21221, 2.21622, 2.22022, 2.22422, 2.22823, 2.23223, 2.23624, 2.24024, 2.24424, 2.24825, 2.25225, 2.25626, 2.26026, 2.26426, 2.26827, 2.27227, 2.27628, 2.28028, 2.28428, 2.28829, 2.29229, 2.2963, 2.3003, 2.3043, 2.30831, 2.31231, 2.31632, 2.32032, 2.32432, 2.32833, 2.33233, 2.33634, 2.34034, 2.34434, 2.34835, 2.35235, 2.35636, 2.36036, 2.36436, 2.36837, 2.37237, 2.37638, 2.38038, 2.38438, 2.38839, 2.39239, 2.3964, 2.4004, 2.4044, 2.40841, 2.41241, 2.41642, 2.42042, 2.42442, 2.42843, 2.43243, 2.43644, 2.44044, 2.44444, 2.44845, 2.45245, 2.45646, 2.46046, 2.46446, 2.46847, 2.47247, 2.47648, 2.48048, 2.48448, 2.48849, 2.49249, 2.4965, 2.5005, 2.5045, 2.50851, 2.51251, 2.51652, 2.52052, 2.52452, 2.52853, 2.53253, 2.53654, 2.54054, 2.54454, 2.54855, 2.55255, 2.55656, 2.56056, 2.56456, 2.56857, 2.57257, 2.57658, 2.58058, 2.58458, 2.58859, 2.59259, 2.5966, 2.6006, 2.6046, 2.60861, 2.61261, 2.61662, 2.62062, 2.62462, 2.62863, 2.63263, 2.63664, 2.64064, 2.64464, 2.64865, 2.65265, 2.65666, 2.66066, 2.66466, 2.66867, 2.67267, 2.67668, 2.68068, 2.68468, 2.68869, 2.69269, 2.6967, 2.7007, 2.7047, 2.70871, 2.71271, 2.71672, 2.72072, 2.72472, 2.72873, 2.73273, 2.73674, 2.74074, 2.74474, 2.74875, 2.75275, 2.75676, 2.76076, 2.76476, 2.76877, 2.77277, 2.77678, 2.78078, 2.78478, 2.78879, 2.79279, 2.7968, 2.8008, 2.8048, 2.80881, 2.81281, 2.81682, 2.82082, 2.82482, 2.82883, 2.83283, 2.83684, 2.84084, 2.84484, 2.84885, 2.85285, 2.85686, 2.86086, 2.86486, 2.86887, 2.87287, 2.87688, 2.88088, 2.88488, 2.88889, 2.89289, 2.8969, 2.9009, 2.9049, 2.90891, 2.91291, 2.91692, 2.92092, 2.92492, 2.92893, 2.93293, 2.93694, 2.94094, 2.94494, 2.94895, 2.95295, 2.95696, 2.96096, 2.96496, 2.96897, 2.97297, 2.97698, 2.98098, 2.98498, 2.98899, 2.99299, 2.997, 3.001, 3.00501, 3.00901, 3.01301, 3.01702, 3.02102, 3.02503, 3.02903, 3.03303, 3.03704, 3.04104, 3.04505, 3.04905, 3.05305, 3.05706, 3.06106, 3.06507, 3.06907, 3.07307, 3.07708, 3.08108, 3.08509, 3.08909, 3.09309, 3.0971, 3.1011, 3.10511, 3.10911, 3.11311, 3.11712, 3.12112, 3.12513, 3.12913, 3.13313, 3.13714, 3.14114, 3.14515, 3.14915, 3.15315, 3.15716, 3.16116, 3.16517, 3.16917, 3.17317, 3.17718, 3.18118, 3.18519, 3.18919, 3.19319, 3.1972, 3.2012, 3.20521, 3.20921, 3.21321, 3.21722, 3.22122, 3.22523, 3.22923, 3.23323, 3.23724, 3.24124, 3.24525, 3.24925, 3.25325, 3.25726, 3.26126, 3.26527, 3.26927, 3.27327, 3.27728, 3.28128, 3.28529, 3.28929, 3.29329, 3.2973, 3.3013, 3.30531, 3.30931, 3.31331, 3.31732, 3.32132, 3.32533, 3.32933, 3.33333, 3.33734, 3.34134, 3.34535, 3.34935, 3.35335, 3.35736, 3.36136, 3.36537, 3.36937, 3.37337, 3.37738, 3.38138, 3.38539, 3.38939, 3.39339, 3.3974, 3.4014, 3.40541, 3.40941, 3.41341, 3.41742, 3.42142, 3.42543, 3.42943, 3.43343, 3.43744, 3.44144, 3.44545, 3.44945, 3.45345, 3.45746, 3.46146, 3.46547, 3.46947, 3.47347, 3.47748, 3.48148, 3.48549, 3.48949, 3.49349, 3.4975, 3.5015, 3.50551, 3.50951, 3.51351, 3.51752, 3.52152, 3.52553, 3.52953, 3.53353, 3.53754, 3.54154, 3.54555, 3.54955, 3.55355, 3.55756, 3.56156, 3.56557, 3.56957, 3.57357, 3.57758, 3.58158, 3.58559, 3.58959, 3.59359, 3.5976, 3.6016, 3.60561, 3.60961, 3.61361, 3.61762, 3.62162, 3.62563, 3.62963, 3.63363, 3.63764, 3.64164, 3.64565, 3.64965, 3.65365, 3.65766, 3.66166, 3.66567, 3.66967, 3.67367, 3.67768, 3.68168, 3.68569, 3.68969, 3.69369, 3.6977, 3.7017, 3.70571, 3.70971, 3.71371, 3.71772, 3.72172, 3.72573, 3.72973, 3.73373, 3.73774, 3.74174, 3.74575, 3.74975, 3.75375, 3.75776, 3.76176, 3.76577, 3.76977, 3.77377, 3.77778, 3.78178, 3.78579, 3.78979, 3.79379, 3.7978, 3.8018, 3.80581, 3.80981, 3.81381, 3.81782, 3.82182, 3.82583, 3.82983, 3.83383, 3.83784, 3.84184, 3.84585, 3.84985, 3.85385, 3.85786, 3.86186, 3.86587, 3.86987, 3.87387, 3.87788, 3.88188, 3.88589, 3.88989, 3.89389, 3.8979, 3.9019, 3.90591, 3.90991, 3.91391, 3.91792, 3.92192, 3.92593, 3.92993, 3.93393, 3.93794, 3.94194, 3.94595, 3.94995, 3.95395, 3.95796, 3.96196, 3.96597, 3.96997, 3.97397, 3.97798, 3.98198, 3.98599, 3.98999, 3.99399, 3.998, 4.002, 4.00601, 4.01001, 4.01401, 4.01802, 4.02202, 4.02603, 4.03003, 4.03403, 4.03804, 4.04204, 4.04605, 4.05005, 4.05405, 4.05806, 4.06206, 4.06607, 4.07007, 4.07407, 4.07808, 4.08208, 4.08609, 4.09009, 4.09409, 4.0981, 4.1021, 4.10611, 4.11011, 4.11411, 4.11812, 4.12212, 4.12613, 4.13013, 4.13413, 4.13814, 4.14214, 4.14615, 4.15015, 4.15415, 4.15816, 4.16216, 4.16617, 4.17017, 4.17417, 4.17818, 4.18218, 4.18619, 4.19019, 4.19419, 4.1982, 4.2022, 4.20621, 4.21021, 4.21421, 4.21822, 4.22222, 4.22623, 4.23023, 4.23423, 4.23824, 4.24224, 4.24625, 4.25025, 4.25425, 4.25826, 4.26226, 4.26627, 4.27027, 4.27427, 4.27828, 4.28228, 4.28629, 4.29029, 4.29429, 4.2983, 4.3023, 4.30631, 4.31031, 4.31431, 4.31832, 4.32232, 4.32633, 4.33033, 4.33433, 4.33834, 4.34234, 4.34635, 4.35035, 4.35435, 4.35836, 4.36236, 4.36637, 4.37037, 4.37437, 4.37838, 4.38238, 4.38639, 4.39039, 4.39439, 4.3984, 4.4024, 4.40641, 4.41041, 4.41441, 4.41842, 4.42242, 4.42643, 4.43043, 4.43443, 4.43844, 4.44244, 4.44645, 4.45045, 4.45445, 4.45846, 4.46246, 4.46647, 4.47047, 4.47447, 4.47848, 4.48248, 4.48649, 4.49049, 4.49449, 4.4985, 4.5025, 4.50651, 4.51051, 4.51451, 4.51852, 4.52252, 4.52653, 4.53053, 4.53453, 4.53854, 4.54254, 4.54655, 4.55055, 4.55455, 4.55856, 4.56256, 4.56657, 4.57057, 4.57457, 4.57858, 4.58258, 4.58659, 4.59059, 4.59459, 4.5986, 4.6026, 4.60661, 4.61061, 4.61461, 4.61862, 4.62262, 4.62663, 4.63063, 4.63463, 4.63864, 4.64264, 4.64665, 4.65065, 4.65465, 4.65866, 4.66266, 4.66667, 4.67067, 4.67467, 4.67868, 4.68268, 4.68669, 4.69069, 4.69469, 4.6987, 4.7027, 4.70671, 4.71071, 4.71471, 4.71872, 4.72272, 4.72673, 4.73073, 4.73473, 4.73874, 4.74274, 4.74675, 4.75075, 4.75475, 4.75876, 4.76276, 4.76677, 4.77077, 4.77477, 4.77878, 4.78278, 4.78679, 4.79079, 4.79479, 4.7988, 4.8028, 4.80681, 4.81081, 4.81481, 4.81882, 4.82282, 4.82683, 4.83083, 4.83483, 4.83884, 4.84284, 4.84685, 4.85085, 4.85485, 4.85886, 4.86286, 4.86687, 4.87087, 4.87487, 4.87888, 4.88288, 4.88689, 4.89089, 4.89489, 4.8989, 4.9029, 4.90691, 4.91091, 4.91491, 4.91892, 4.92292, 4.92693, 4.93093, 4.93493, 4.93894, 4.94294, 4.94695, 4.95095, 4.95495, 4.95896, 4.96296, 4.96697, 4.97097, 4.97497, 4.97898, 4.98298, 4.98699, 4.99099, 4.99499, 4.999, 5.003, 5.00701, 5.01101, 5.01502, 5.01902, 5.02302, 5.02703, 5.03103, 5.03504, 5.03904, 5.04304, 5.04705, 5.05105, 5.05506, 5.05906, 5.06306, 5.06707, 5.07107, 5.07508, 5.07908, 5.08308, 5.08709, 5.09109, 5.0951, 5.0991, 5.1031, 5.10711, 5.11111, 5.11512, 5.11912, 5.12312, 5.12713, 5.13113, 5.13514, 5.13914, 5.14314, 5.14715, 5.15115, 5.15516, 5.15916, 5.16316, 5.16717, 5.17117, 5.17518, 5.17918, 5.18318, 5.18719, 5.19119, 5.1952, 5.1992, 5.2032, 5.20721, 5.21121, 5.21522, 5.21922, 5.22322, 5.22723, 5.23123, 5.23524, 5.23924, 5.24324, 5.24725, 5.25125, 5.25526, 5.25926, 5.26326, 5.26727, 5.27127, 5.27528, 5.27928, 5.28328, 5.28729, 5.29129, 5.2953, 5.2993, 5.3033, 5.30731, 5.31131, 5.31532, 5.31932, 5.32332, 5.32733, 5.33133, 5.33534, 5.33934, 5.34334, 5.34735, 5.35135, 5.35536, 5.35936, 5.36336, 5.36737, 5.37137, 5.37538, 5.37938, 5.38338, 5.38739, 5.39139, 5.3954, 5.3994, 5.4034, 5.40741, 5.41141, 5.41542, 5.41942, 5.42342, 5.42743, 5.43143, 5.43544, 5.43944, 5.44344, 5.44745, 5.45145, 5.45546, 5.45946, 5.46346, 5.46747, 5.47147, 5.47548, 5.47948, 5.48348, 5.48749, 5.49149, 5.4955, 5.4995, 5.5035, 5.50751, 5.51151, 5.51552, 5.51952, 5.52352, 5.52753, 5.53153, 5.53554, 5.53954, 5.54354, 5.54755, 5.55155, 5.55556, 5.55956, 5.56356, 5.56757, 5.57157, 5.57558, 5.57958, 5.58358, 5.58759, 5.59159, 5.5956, 5.5996, 5.6036, 5.60761, 5.61161, 5.61562, 5.61962, 5.62362, 5.62763, 5.63163, 5.63564, 5.63964, 5.64364, 5.64765, 5.65165, 5.65566, 5.65966, 5.66366, 5.66767, 5.67167, 5.67568, 5.67968, 5.68368, 5.68769, 5.69169, 5.6957, 5.6997, 5.7037, 5.70771, 5.71171, 5.71572, 5.71972, 5.72372, 5.72773, 5.73173, 5.73574, 5.73974, 5.74374, 5.74775, 5.75175, 5.75576, 5.75976, 5.76376, 5.76777, 5.77177, 5.77578, 5.77978, 5.78378, 5.78779, 5.79179, 5.7958, 5.7998, 5.8038, 5.80781, 5.81181, 5.81582, 5.81982, 5.82382, 5.82783, 5.83183, 5.83584, 5.83984, 5.84384, 5.84785, 5.85185, 5.85586, 5.85986, 5.86386, 5.86787, 5.87187, 5.87588, 5.87988, 5.88388, 5.88789, 5.89189, 5.8959, 5.8999, 5.9039, 5.90791, 5.91191, 5.91592, 5.91992, 5.92392, 5.92793, 5.93193, 5.93594, 5.93994, 5.94394, 5.94795, 5.95195, 5.95596, 5.95996, 5.96396, 5.96797, 5.97197, 5.97598, 5.97998, 5.98398, 5.98799, 5.99199, 5.996, 6};
        vector<double>FSiSiCorrect = {0.0931832, 0.0927847, 0.0923887, 0.091995, 0.0916037, 0.0912147, 0.0908281, 0.0904438, 0.0900618, 0.0896821, 0.0893047, 0.0889295, 0.0885565, 0.0881857, 0.0878172, 0.0874508, 0.0870865, 0.0867244, 0.0863645, 0.0860066, 0.0856509, 0.0852972, 0.0849456, 0.084596, 0.0842484, 0.0839029, 0.0835593, 0.0832178, 0.0828782, 0.0825406, 0.0822048, 0.0818711, 0.0815392, 0.0812092, 0.0808811, 0.0805549, 0.0802305, 0.079908, 0.0795872, 0.0792683, 0.0789512, 0.0786359, 0.0783223, 0.0780105, 0.0777004, 0.0773921, 0.0770855, 0.0767806, 0.0764774, 0.0761758, 0.075876, 0.0755778, 0.0752812, 0.0749863, 0.0746929, 0.0744012, 0.0741111, 0.0738226, 0.0735356, 0.0732502, 0.0729664, 0.0726841, 0.0724033, 0.0721241, 0.0718463, 0.0715701, 0.0712953, 0.071022, 0.0707502, 0.0704798, 0.0702109, 0.0699434, 0.0696773, 0.0694127, 0.0691494, 0.0688876, 0.0686271, 0.068368, 0.0681103, 0.0678539, 0.0675989, 0.0673452, 0.0670928, 0.0668418, 0.066592, 0.0663436, 0.0660964, 0.0658506, 0.065606, 0.0653627, 0.0651206, 0.0648798, 0.0646402, 0.0644018, 0.0641647, 0.0639288, 0.0636941, 0.0634606, 0.0632283, 0.0629972, 0.0627672, 0.0625384, 0.0623108, 0.0620843, 0.061859, 0.0616348, 0.0614117, 0.0611897, 0.0609689, 0.0607492, 0.0605305, 0.060313, 0.0600965, 0.0598811, 0.0596668, 0.0594536, 0.0592414, 0.0590303, 0.0588202, 0.0586111, 0.0584031, 0.058196, 0.05799, 0.0577851, 0.0575811, 0.0573781, 0.0571761, 0.0569751, 0.0567751, 0.056576, 0.0563779, 0.0561808, 0.0559846, 0.0557893, 0.055595, 0.0554017, 0.0552092, 0.0550177, 0.0548271, 0.0546374, 0.0544487, 0.0542608, 0.0540738, 0.0538877, 0.0537025, 0.0535181, 0.0533347, 0.0531521, 0.0529704, 0.0527895, 0.0526095, 0.0524303, 0.0522519, 0.0520744, 0.0518978, 0.0517219, 0.0515469, 0.0513727, 0.0511993, 0.0510267, 0.0508549, 0.0506839, 0.0505137, 0.0503442, 0.0501756, 0.0500077, 0.0498406, 0.0496743, 0.0495087, 0.0493439, 0.0491799, 0.0490165, 0.048854, 0.0486922, 0.0485311, 0.0483707, 0.0482111, 0.0480522, 0.047894, 0.0477365, 0.0475797, 0.0474237, 0.0472683, 0.0471137, 0.0469597, 0.0468064, 0.0466538, 0.0465019, 0.0463507, 0.0462001, 0.0460502, 0.045901, 0.0457524, 0.0456045, 0.0454572, 0.0453106, 0.0451647, 0.0450194, 0.0448747, 0.0447306, 0.0445872, 0.0444444, 0.0443023, 0.0441607, 0.0440198, 0.0438795, 0.0437398, 0.0436007, 0.0434622, 0.0433243, 0.043187, 0.0430503, 0.0429142, 0.0427787, 0.0426438, 0.0425094, 0.0423756, 0.0422424, 0.0421098, 0.0419777, 0.0418462, 0.0417153, 0.0415849, 0.041455, 0.0413257, 0.041197, 0.0410688, 0.0409412, 0.0408141, 0.0406875, 0.0405614, 0.0404359, 0.040311, 0.0401865, 0.0400626, 0.0399391, 0.0398162, 0.0396939, 0.039572, 0.0394506, 0.0393298, 0.0392094, 0.0390895, 0.0389702, 0.0388513, 0.0387329, 0.038615, 0.0384976, 0.0383807, 0.0382643, 0.0381483, 0.0380328, 0.0379178, 0.0378033, 0.0376892, 0.0375756, 0.0374624, 0.0373497, 0.0372375, 0.0371257, 0.0370144, 0.0369036, 0.0367932, 0.0366832, 0.0365737, 0.0364646, 0.0363559, 0.0362477, 0.0361399, 0.0360326, 0.0359257, 0.0358192, 0.0357132, 0.0356075, 0.0355023, 0.0353975, 0.0352932, 0.0351892, 0.0350856, 0.0349825, 0.0348798, 0.0347775, 0.0346755, 0.034574, 0.0344729, 0.0343722, 0.0342719, 0.0341719, 0.0340724, 0.0339733, 0.0338745, 0.0337761, 0.0336782, 0.0335805, 0.0334833, 0.0333865, 0.03329, 0.0331939, 0.0330982, 0.0330028, 0.0329079, 0.0328132, 0.032719, 0.0326251, 0.0325316, 0.0324384, 0.0323456, 0.0322532, 0.0321611, 0.0320693, 0.0319779, 0.0318869, 0.0317962, 0.0317058, 0.0316158, 0.0315261, 0.0314368, 0.0313478, 0.0312592, 0.0311709, 0.0310829, 0.0309952, 0.0309079, 0.0308209, 0.0307343, 0.0306479, 0.0305619, 0.0304762, 0.0303909, 0.0303058, 0.0302211, 0.0301367, 0.0300526, 0.0299688, 0.0298853, 0.0298022, 0.0297193, 0.0296368, 0.0295545, 0.0294726, 0.029391, 0.0293096, 0.0292286, 0.0291479, 0.0290674, 0.0289873, 0.0289075, 0.0288279, 0.0287486, 0.0286697, 0.028591, 0.0285126, 0.0284345, 0.0283567, 0.0282791, 0.0282019, 0.0281249, 0.0280482, 0.0279718, 0.0278956, 0.0278198, 0.0277442, 0.0276689, 0.0275938, 0.027519, 0.0274445, 0.0273703, 0.0272963, 0.0272226, 0.0271492, 0.027076, 0.0270031, 0.0269304, 0.026858, 0.0267859, 0.026714, 0.0266424, 0.026571, 0.0264999, 0.026429, 0.0263584, 0.026288, 0.0262179, 0.026148, 0.0260784, 0.026009, 0.0259399, 0.025871, 0.0258024, 0.025734, 0.0256658, 0.0255979, 0.0255302, 0.0254627, 0.0253955, 0.0253285, 0.0252618, 0.0251953, 0.025129, 0.0250629, 0.0249971, 0.0249315, 0.0248661, 0.024801, 0.0247361, 0.0246714, 0.0246069, 0.0245427, 0.0244786, 0.0244148, 0.0243512, 0.0242879, 0.0242247, 0.0241618, 0.0240991, 0.0240365, 0.0239743, 0.0239122, 0.0238503, 0.0237886, 0.0237272, 0.023666, 0.0236049, 0.0235441, 0.0234835, 0.0234231, 0.0233629, 0.0233029, 0.0232431, 0.0231835, 0.0231241, 0.0230649, 0.0230059, 0.0229471, 0.0228885, 0.0228301, 0.0227719, 0.0227138, 0.022656, 0.0225984, 0.0225409, 0.0224837, 0.0224266, 0.0223698, 0.0223131, 0.0222566, 0.0222003, 0.0221442, 0.0220883, 0.0220325, 0.021977, 0.0219216, 0.0218664, 0.0218114, 0.0217566, 0.0217019, 0.0216475, 0.0215932, 0.0215391, 0.0214851, 0.0214314, 0.0213778, 0.0213244, 0.0212712, 0.0212181, 0.0211652, 0.0211125, 0.02106, 0.0210076, 0.0209554, 0.0209034, 0.0208515, 0.0207998, 0.0207483, 0.0206969, 0.0206457, 0.0205947, 0.0205438, 0.0204931, 0.0204426, 0.0203922, 0.020342, 0.020292, 0.0202421, 0.0201923, 0.0201428, 0.0200934, 0.0200441, 0.019995, 0.0199461, 0.0198973, 0.0198486, 0.0198002, 0.0197519, 0.0197037, 0.0196557, 0.0196078, 0.0195601, 0.0195125, 0.0194651, 0.0194179, 0.0193708, 0.0193238, 0.019277, 0.0192303, 0.0191838, 0.0191374, 0.0190912, 0.0190451, 0.0189992, 0.0189534, 0.0189077, 0.0188622, 0.0188168, 0.0187716, 0.0187265, 0.0186816, 0.0186368, 0.0185921, 0.0185476, 0.0185032, 0.018459, 0.0184148, 0.0183709, 0.018327, 0.0182833, 0.0182398, 0.0181963, 0.018153, 0.0181098, 0.0180668, 0.0180239, 0.0179811, 0.0179385, 0.017896, 0.0178536, 0.0178114, 0.0177692, 0.0177273, 0.0176854, 0.0176437, 0.017602, 0.0175606, 0.0175192, 0.017478, 0.0174369, 0.0173959, 0.017355, 0.0173143, 0.0172737, 0.0172332, 0.0171929, 0.0171526, 0.0171125, 0.0170725, 0.0170326, 0.0169929, 0.0169532, 0.0169137, 0.0168743, 0.016835, 0.0167959, 0.0167568, 0.0167179, 0.0166791, 0.0166404, 0.0166018, 0.0165633, 0.016525, 0.0164867, 0.0164486, 0.0164106, 0.0163727, 0.0163349, 0.0162973, 0.0162597, 0.0162222, 0.0161849, 0.0161477, 0.0161106, 0.0160735, 0.0160366, 0.0159999, 0.0159632, 0.0159266, 0.0158901, 0.0158538, 0.0158175, 0.0157814, 0.0157453, 0.0157094, 0.0156736, 0.0156378, 0.0156022, 0.0155667, 0.0155313, 0.015496, 0.0154608, 0.0154257, 0.0153907, 0.0153558, 0.015321, 0.0152863, 0.0152517, 0.0152172, 0.0151828, 0.0151485, 0.0151143, 0.0150802, 0.0150462, 0.0150123, 0.0149785, 0.0149448, 0.0149111, 0.0148776, 0.0148442, 0.0148109, 0.0147777, 0.0147445, 0.0147115, 0.0146785, 0.0146457, 0.0146129, 0.0145803, 0.0145477, 0.0145152, 0.0144829, 0.0144506, 0.0144184, 0.0143863, 0.0143542, 0.0143223, 0.0142905, 0.0142587, 0.0142271, 0.0141955, 0.014164, 0.0141326, 0.0141013, 0.0140701, 0.014039, 0.014008, 0.013977, 0.0139462, 0.0139154, 0.0138847, 0.0138541, 0.0138236, 0.0137932, 0.0137628, 0.0137326, 0.0137024, 0.0136723, 0.0136423, 0.0136124, 0.0135825, 0.0135528, 0.0135231, 0.0134935, 0.013464, 0.0134346, 0.0134052, 0.013376, 0.0133468, 0.0133177, 0.0132886, 0.0132597, 0.0132308, 0.0132021, 0.0131734, 0.0131447, 0.0131162, 0.0130877, 0.0130593, 0.013031, 0.0130028, 0.0129746, 0.0129466, 0.0129186, 0.0128906, 0.0128628, 0.012835, 0.0128073, 0.0127797, 0.0127522, 0.0127247, 0.0126973, 0.01267, 0.0126427, 0.0126156, 0.0125885, 0.0125614, 0.0125345, 0.0125076, 0.0124808, 0.0124541, 0.0124274, 0.0124008, 0.0123743, 0.0123479, 0.0123215, 0.0122952, 0.0122689, 0.0122428, 0.0122167, 0.0121907, 0.0121647, 0.0121388, 0.012113, 0.0120873, 0.0120616, 0.012036, 0.0120105, 0.011985, 0.0119596, 0.0119343, 0.011909, 0.0118838, 0.0118587, 0.0118336, 0.0118086, 0.0117837, 0.0117588, 0.011734, 0.0117093, 0.0116847, 0.0116601, 0.0116355, 0.011611, 0.0115866, 0.0115623, 0.011538, 0.0115138, 0.0114897, 0.0114656, 0.0114416, 0.0114176, 0.0113937, 0.0113699, 0.0113461, 0.0113224, 0.0112987, 0.0112752, 0.0112516, 0.0112282, 0.0112048, 0.0111814, 0.0111582, 0.011135, 0.0111118, 0.0110887, 0.0110657, 0.0110427, 0.0110198, 0.0109969, 0.0109741, 0.0109514, 0.0109287, 0.0109061, 0.0108835, 0.010861, 0.0108386, 0.0108162, 0.0107939, 0.0107716, 0.0107494, 0.0107272, 0.0107051, 0.0106831, 0.0106611, 0.0106392, 0.0106173, 0.0105955, 0.0105737, 0.010552, 0.0105304, 0.0105088, 0.0104873, 0.0104658, 0.0104444, 0.010423, 0.0104017, 0.0103804, 0.0103592, 0.010338, 0.0103169, 0.0102959, 0.0102749, 0.010254, 0.0102331, 0.0102122, 0.0101915, 0.0101707, 0.0101501, 0.0101294, 0.0101089, 0.0100883, 0.0100679, 0.0100475, 0.0100271, 0.0100068, 0.00998653, 0.00996632, 0.00994616, 0.00992605, 0.009906, 0.00988599, 0.00986603, 0.00984613, 0.00982627, 0.00980646, 0.00978671, 0.009767, 0.00974734, 0.00972773, 0.00970817, 0.00968866, 0.0096692, 0.00964979, 0.00963042, 0.0096111, 0.00959184, 0.00957261, 0.00955344, 0.00953432, 0.00951524, 0.00949621, 0.00947723, 0.00945829, 0.0094394, 0.00942056, 0.00940176, 0.00938301, 0.00936431, 0.00934565, 0.00932704, 0.00930848, 0.00928996, 0.00927149, 0.00925306, 0.00923468, 0.00921634, 0.00919805, 0.0091798, 0.0091616, 0.00914345, 0.00912533, 0.00910726, 0.00908924, 0.00907126, 0.00905333, 0.00903543, 0.00901759, 0.00899978, 0.00898202, 0.0089643, 0.00894663, 0.008929, 0.00891141, 0.00889386, 0.00887636, 0.0088589, 0.00884148, 0.00882411, 0.00880677, 0.00878948, 0.00877223, 0.00875503, 0.00873786, 0.00872074, 0.00870365, 0.00868661, 0.00866961, 0.00865265, 0.00863574, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        vector<double>FSiOCorrect = {-0.0354608, -0.0355015, -0.0355379, -0.0355702, -0.0355986, -0.035623, -0.0356437, -0.0356607, -0.0356742, -0.0356843, -0.035691, -0.0356944, -0.0356947, -0.035692, -0.0356863, -0.0356777, -0.0356663, -0.0356522, -0.0356354, -0.0356161, -0.0355943, -0.0355702, -0.0355437, -0.0355149, -0.035484, -0.0354509, -0.0354158, -0.0353787, -0.0353396, -0.0352987, -0.0352559, -0.0352114, -0.0351653, -0.0351174, -0.035068, -0.035017, -0.0349645, -0.0349106, -0.0348553, -0.0347986, -0.0347406, -0.0346814, -0.0346209, -0.0345593, -0.0344965, -0.0344326, -0.0343676, -0.0343016, -0.0342347, -0.0341667, -0.0340979, -0.0340282, -0.0339576, -0.0338861, -0.0338139, -0.0337409, -0.0336672, -0.0335928, -0.0335177, -0.033442, -0.0333656, -0.0332886, -0.033211, -0.0331329, -0.0330543, -0.0329751, -0.0328955, -0.0328154, -0.0327349, -0.0326539, -0.0325726, -0.0324908, -0.0324087, -0.0323263, -0.0322435, -0.0321604, -0.0320771, -0.0319934, -0.0319095, -0.0318253, -0.0317409, -0.0316563, -0.0315715, -0.0314865, -0.0314014, -0.0313161, -0.0312306, -0.031145, -0.0310593, -0.0309734, -0.0308875, -0.0308015, -0.0307154, -0.0306292, -0.030543, -0.0304567, -0.0303704, -0.030284, -0.0301977, -0.0301113, -0.0300249, -0.0299386, -0.0298522, -0.0297659, -0.0296796, -0.0295934, -0.0295072, -0.029421, -0.0293349, -0.0292489, -0.0291629, -0.0290771, -0.0289913, -0.0289056, -0.02882, -0.0287345, -0.0286491, -0.0285638, -0.0284786, -0.0283936, -0.0283087, -0.0282239, -0.0281393, -0.0280547, -0.0279704, -0.0278862, -0.0278021, -0.0277182, -0.0276345, -0.0275509, -0.0274675, -0.0273843, -0.0273012, -0.0272183, -0.0271356, -0.0270531, -0.0269707, -0.0268886, -0.0268066, -0.0267248, -0.0266433, -0.0265619, -0.0264807, -0.0263997, -0.026319, -0.0262384, -0.026158, -0.0260779, -0.025998, -0.0259182, -0.0258387, -0.0257594, -0.0256804, -0.0256015, -0.0255229, -0.0254445, -0.0253663, -0.0252883, -0.0252106, -0.0251331, -0.0250558, -0.0249788, -0.0249019, -0.0248254, -0.024749, -0.0246729, -0.024597, -0.0245213, -0.0244459, -0.0243707, -0.0242957, -0.024221, -0.0241465, -0.0240723, -0.0239983, -0.0239245, -0.0238509, -0.0237776, -0.0237046, -0.0236318, -0.0235592, -0.0234868, -0.0234147, -0.0233429, -0.0232712, -0.0231998, -0.0231287, -0.0230578, -0.0229871, -0.0229167, -0.0228465, -0.0227765, -0.0227068, -0.0226373, -0.0225681, -0.0224991, -0.0224303, -0.0223618, -0.0222935, -0.0222254, -0.0221576, -0.02209, -0.0220227, -0.0219556, -0.0218887, -0.0218221, -0.0217557, -0.0216895, -0.0216236, -0.0215579, -0.0214924, -0.0214272, -0.0213622, -0.0212974, -0.0212329, -0.0211686, -0.0211045, -0.0210407, -0.0209771, -0.0209137, -0.0208505, -0.0207876, -0.0207249, -0.0206624, -0.0206001, -0.0205381, -0.0204763, -0.0204147, -0.0203534, -0.0202923, -0.0202313, -0.0201707, -0.0201102, -0.02005, -0.0199899, -0.0199301, -0.0198705, -0.0198112, -0.019752, -0.0196931, -0.0196344, -0.0195759, -0.0195176, -0.0194595, -0.0194016, -0.019344, -0.0192865, -0.0192293, -0.0191723, -0.0191155, -0.0190589, -0.0190025, -0.0189463, -0.0188903, -0.0188346, -0.018779, -0.0187236, -0.0186685, -0.0186135, -0.0185588, -0.0185042, -0.0184499, -0.0183957, -0.0183418, -0.018288, -0.0182345, -0.0181811, -0.018128, -0.018075, -0.0180222, -0.0179697, -0.0179173, -0.0178651, -0.0178131, -0.0177613, -0.0177097, -0.0176583, -0.017607, -0.017556, -0.0175051, -0.0174545, -0.017404, -0.0173537, -0.0173036, -0.0172536, -0.0172039, -0.0171543, -0.017105, -0.0170558, -0.0170068, -0.0169579, -0.0169093, -0.0168608, -0.0168125, -0.0167644, -0.0167164, -0.0166686, -0.016621, -0.0165736, -0.0165264, -0.0164793, -0.0164324, -0.0163857, -0.0163391, -0.0162927, -0.0162465, -0.0162004, -0.0161545, -0.0161088, -0.0160633, -0.0160179, -0.0159727, -0.0159276, -0.0158827, -0.015838, -0.0157934, -0.015749, -0.0157048, -0.0156607, -0.0156168, -0.015573, -0.0155294, -0.0154859, -0.0154427, -0.0153995, -0.0153565, -0.0153137, -0.0152711, -0.0152285, -0.0151862, -0.015144, -0.0151019, -0.01506, -0.0150182, -0.0149766, -0.0149352, -0.0148939, -0.0148527, -0.0148117, -0.0147708, -0.0147301, -0.0146896, -0.0146491, -0.0146088, -0.0145687, -0.0145287, -0.0144889, -0.0144491, -0.0144096, -0.0143701, -0.0143309, -0.0142917, -0.0142527, -0.0142138, -0.0141751, -0.0141365, -0.014098, -0.0140597, -0.0140215, -0.0139835, -0.0139455, -0.0139078, -0.0138701, -0.0138326, -0.0137952, -0.0137579, -0.0137208, -0.0136838, -0.013647, -0.0136102, -0.0135736, -0.0135371, -0.0135008, -0.0134646, -0.0134285, -0.0133925, -0.0133566, -0.0133209, -0.0132853, -0.0132499, -0.0132145, -0.0131793, -0.0131442, -0.0131092, -0.0130743, -0.0130396, -0.013005, -0.0129705, -0.0129361, -0.0129018, -0.0128677, -0.0128337, -0.0127998, -0.012766, -0.0127323, -0.0126987, -0.0126653, -0.012632, -0.0125987, -0.0125656, -0.0125327, -0.0124998, -0.012467, -0.0124344, -0.0124018, -0.0123694, -0.0123371, -0.0123049, -0.0122728, -0.0122408, -0.0122089, -0.0121771, -0.0121455, -0.0121139, -0.0120825, -0.0120511, -0.0120199, -0.0119887, -0.0119577, -0.0119268, -0.011896, -0.0118653, -0.0118347, -0.0118041, -0.0117737, -0.0117434, -0.0117132, -0.0116831, -0.0116531, -0.0116232, -0.0115934, -0.0115637, -0.0115341, -0.0115046, -0.0114752, -0.0114459, -0.0114167, -0.0113876, -0.0113586, -0.0113297, -0.0113008, -0.0112721, -0.0112435, -0.011215, -0.0111865, -0.0111582, -0.0111299, -0.0111017, -0.0110737, -0.0110457, -0.0110178, -0.01099, -0.0109623, -0.0109347, -0.0109072, -0.0108797, -0.0108524, -0.0108252, -0.010798, -0.0107709, -0.0107439, -0.010717, -0.0106902, -0.0106635, -0.0106369, -0.0106103, -0.0105838, -0.0105575, -0.0105312, -0.010505, -0.0104788, -0.0104528, -0.0104268, -0.010401, -0.0103752, -0.0103495, -0.0103239, -0.0102983, -0.0102729, -0.0102475, -0.0102222, -0.010197, -0.0101719, -0.0101468, -0.0101218, -0.0100969, -0.0100721, -0.0100474, -0.0100227, -0.00999816, -0.00997366, -0.00994924, -0.0099249, -0.00990063, -0.00987644, -0.00985233, -0.0098283, -0.00980434, -0.00978045, -0.00975664, -0.00973291, -0.00970925, -0.00968567, -0.00966216, -0.00963872, -0.00961536, -0.00959207, -0.00956885, -0.00954571, -0.00952264, -0.00949964, -0.00947671, -0.00945386, -0.00943107, -0.00940836, -0.00938572, -0.00936315, -0.00934065, -0.00931822, -0.00929585, -0.00927356, -0.00925134, -0.00922918, -0.0092071, -0.00918508, -0.00916313, -0.00914125, -0.00911944, -0.00909769, -0.00907601, -0.0090544, -0.00903285, -0.00901137, -0.00898995, -0.0089686, -0.00894732, -0.0089261, -0.00890495, -0.00888386, -0.00886284, -0.00884188, -0.00882098, -0.00880015, -0.00877938, -0.00875867, -0.00873803, -0.00871745, -0.00869693, -0.00867648, -0.00865609, -0.00863575, -0.00861548, -0.00859528, -0.00857513, -0.00855504, -0.00853502, -0.00851505, -0.00849514, -0.0084753, -0.00845551, -0.00843579, -0.00841612, -0.00839651, -0.00837696, -0.00835747, -0.00833804, -0.00831866, -0.00829935, -0.00828009, -0.00826088, -0.00824174, -0.00822265, -0.00820362, -0.00818465, -0.00816573, -0.00814687, -0.00812806, -0.00810931, -0.00809062, -0.00807198, -0.0080534, -0.00803487, -0.0080164, -0.00799798, -0.00797961, -0.0079613, -0.00794304, -0.00792484, -0.00790669, -0.00788859, -0.00787055, -0.00785256, -0.00783462, -0.00781674, -0.0077989, -0.00778112, -0.00776339, -0.00774571, -0.00772809, -0.00771051, -0.00769299, -0.00767552, -0.0076581, -0.00764073, -0.00762341, -0.00760614, -0.00758892, -0.00757175, -0.00755463, -0.00753756, -0.00752053, -0.00750356, -0.00748664, -0.00746976, -0.00745294, -0.00743616, -0.00741943, -0.00740275, -0.00738612, -0.00736953, -0.00735299, -0.0073365, -0.00732006, -0.00730366, -0.00728731, -0.00727101, -0.00725475, -0.00723854, -0.00722238, -0.00720626, -0.00719019, -0.00717416, -0.00715818, -0.00714225, -0.00712636, -0.00711051, -0.00709471, -0.00707896, -0.00706325, -0.00704758, -0.00703196, -0.00701638, -0.00700085, -0.00698536, -0.00696991, -0.00695451, -0.00693915, -0.00692383, -0.00690856, -0.00689333, -0.00687814, -0.006863, -0.00684789, -0.00683283, -0.00681782, -0.00680284, -0.0067879, -0.00677301, -0.00675816, -0.00674335, -0.00672858, -0.00671385, -0.00669917, -0.00668452, -0.00666992, -0.00665535, -0.00664083, -0.00662634, -0.0066119, -0.00659749, -0.00658313, -0.0065688, -0.00655452, -0.00654027, -0.00652607, -0.0065119, -0.00649777, -0.00648368, -0.00646963, -0.00645562, -0.00644164, -0.00642771, -0.00641381, -0.00639995, -0.00638613, -0.00637235, -0.0063586, -0.00634489, -0.00633122, -0.00631759, -0.00630399, -0.00629043, -0.00627691, -0.00626343, -0.00624998, -0.00623656, -0.00622319, -0.00620985, -0.00619654, -0.00618328, -0.00617004, -0.00615685, -0.00614369, -0.00613056, -0.00611747, -0.00610442, -0.0060914, -0.00607842, -0.00606547, -0.00605255, -0.00603967, -0.00602683, -0.00601402, -0.00600124, -0.0059885, -0.00597579, -0.00596312, -0.00595048, -0.00593787, -0.0059253, -0.00591276, -0.00590026, -0.00588778, -0.00587534, -0.00586294, -0.00585057, -0.00583823, -0.00582592, -0.00581364, -0.0058014, -0.00578919, -0.00577702, -0.00576487, -0.00575276, -0.00574068, -0.00572863, -0.00571661, -0.00570463, -0.00569267, -0.00568075, -0.00566886, -0.005657, -0.00564517, -0.00563337, -0.00562161, -0.00560987, -0.00559817, -0.00558649, -0.00557485, -0.00556324, -0.00555165, -0.0055401, -0.00552858, -0.00551709, -0.00550562, -0.00549419, -0.00548279, -0.00547142, -0.00546007, -0.00544876, -0.00543747, -0.00542622, -0.00541499, -0.0054038, -0.00539263, -0.00538149, -0.00537038, -0.0053593, -0.00534825, -0.00533722, -0.00532623, -0.00531526, -0.00530432, -0.00529341, -0.00528253, -0.00527167, -0.00526084, -0.00525004, -0.00523927, -0.00522853, -0.00521781, -0.00520712, -0.00519646, -0.00518583, -0.00517522, -0.00516464, -0.00515409, -0.00514356, -0.00513306, -0.00512259, -0.00511215, -0.00510173, -0.00509133, -0.00508097, -0.00507063, -0.00506032, -0.00505003, -0.00503977, -0.00502953, -0.00501932, -0.00500914, -0.00499898, -0.00498885, -0.00497874, -0.00496866, -0.00495861, -0.00494858, -0.00493857, -0.00492859, -0.00491864, -0.00490871, -0.0048988, -0.00488892, -0.00487907, -0.00486924, -0.00485943, -0.00484965, -0.0048399, -0.00483016, -0.00482046, -0.00481077, -0.00480111, -0.00479148, -0.00478187, -0.00477228, -0.00476272, -0.00475318, -0.00474366, -0.00473417, -0.0047247, -0.00471526, -0.00470584, -0.00469644, -0.00468707, -0.00467771, -0.00466839, -0.00465908, -0.0046498, -0.00464054, -0.0046313, -0.00462209, -0.0046129, -0.00460373, -0.00459459, -0.00458546, -0.00457636, -0.00456728, -0.00455823, -0.00454919, -0.00454018, -0.00453119, -0.00452223, -0.00451328, -0.00450436, -0.00449546, -0.00448658, -0.00447772, -0.00446888, -0.00446007, -0.00445127, -0.0044425, -0.00443375, -0.00442502, -0.00441632, -0.00440763, -0.00439896, -0.00439032, -0.0043817, -0.00437309, -0.00436451, -0.00435595, -0.00434741, -0.00433889, -0.00433039, -0.00432192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        vector<double>FOOCorrect = {0.21121, 0.208122, 0.205089, 0.202108, 0.199179, 0.196301, 0.193472, 0.190693, 0.187961, 0.185276, 0.182638, 0.180044, 0.177495, 0.174989, 0.172526, 0.170105, 0.167725, 0.165385, 0.163084, 0.160822, 0.158598, 0.156411, 0.154261, 0.152146, 0.150067, 0.148022, 0.146011, 0.144034, 0.142089, 0.140176, 0.138294, 0.136443, 0.134622, 0.132831, 0.13107, 0.129336, 0.127631, 0.125954, 0.124303, 0.122679, 0.121082, 0.119509, 0.117962, 0.11644, 0.114942, 0.113467, 0.112016, 0.110588, 0.109183, 0.107799, 0.106438, 0.105097, 0.103778, 0.102479, 0.101201, 0.0999419, 0.0987027, 0.0974827, 0.0962816, 0.095099, 0.0939345, 0.0927879, 0.0916588, 0.090547, 0.0894521, 0.0883739, 0.087312, 0.0862662, 0.0852362, 0.0842218, 0.0832225, 0.0822383, 0.0812688, 0.0803138, 0.079373, 0.0784463, 0.0775332, 0.0766337, 0.0757475, 0.0748744, 0.0740141, 0.0731664, 0.0723312, 0.0715081, 0.0706971, 0.0698978, 0.0691102, 0.068334, 0.067569, 0.066815, 0.0660719, 0.0653394, 0.0646175, 0.0639059, 0.0632044, 0.0625129, 0.0618312, 0.0611592, 0.0604967, 0.0598435, 0.0591996, 0.0585647, 0.0579386, 0.0573214, 0.0567127, 0.0561125, 0.0555207, 0.0549371, 0.0543615, 0.0537939, 0.0532341, 0.0526819, 0.0521374, 0.0516003, 0.0510705, 0.0505479, 0.0500325, 0.049524, 0.0490224, 0.0485276, 0.0480394, 0.0475578, 0.0470826, 0.0466138, 0.0461513, 0.0456949, 0.0452446, 0.0448002, 0.0443617, 0.043929, 0.043502, 0.0430807, 0.0426648, 0.0422544, 0.0418493, 0.0414495, 0.0410549, 0.0406654, 0.0402809, 0.0399014, 0.0395268, 0.039157, 0.0387919, 0.0384315, 0.0380757, 0.0377244, 0.0373776, 0.0370351, 0.036697, 0.0363632, 0.0360335, 0.035708, 0.0353866, 0.0350691, 0.0347557, 0.0344461, 0.0341404, 0.0338384, 0.0335402, 0.0332457, 0.0329548, 0.0326674, 0.0323836, 0.0321032, 0.0318262, 0.0315526, 0.0312823, 0.0310153, 0.0307515, 0.0304909, 0.0302334, 0.029979, 0.0297276, 0.0294793, 0.0292338, 0.0289913, 0.0287517, 0.0285149, 0.0282809, 0.0280496, 0.0278211, 0.0275952, 0.0273719, 0.0271513, 0.0269332, 0.0267176, 0.0265046, 0.026294, 0.0260858, 0.02588, 0.0256766, 0.0254754, 0.0252766, 0.02508, 0.0248857, 0.0246936, 0.0245036, 0.0243158, 0.0241301, 0.0239464, 0.0237648, 0.0235853, 0.0234077, 0.0232321, 0.0230584, 0.0228867, 0.0227169, 0.0225489, 0.0223827, 0.0222184, 0.0220559, 0.0218951, 0.0217361, 0.0215788, 0.0214232, 0.0212693, 0.021117, 0.0209664, 0.0208174, 0.02067, 0.0205241, 0.0203798, 0.020237, 0.0200957, 0.0199559, 0.0198176, 0.0196807, 0.0195453, 0.0194112, 0.0192786, 0.0191474, 0.0190175, 0.0188889, 0.0187617, 0.0186357, 0.0185111, 0.0183877, 0.0182656, 0.0181448, 0.0180251, 0.0179067, 0.0177895, 0.0176734, 0.0175585, 0.0174448, 0.0173322, 0.0172207, 0.0171104, 0.0170011, 0.0168929, 0.0167858, 0.0166797, 0.0165747, 0.0164707, 0.0163677, 0.0162657, 0.0161647, 0.0160647, 0.0159657, 0.0158676, 0.0157704, 0.0156742, 0.0155789, 0.0154845, 0.015391, 0.0152984, 0.0152067, 0.0151159, 0.0150259, 0.0149367, 0.0148484, 0.0147609, 0.0146742, 0.0145883, 0.0145032, 0.0144189, 0.0143354, 0.0142527, 0.0141707, 0.0140894, 0.0140089, 0.0139292, 0.0138501, 0.0137718, 0.0136942, 0.0136173, 0.0135411, 0.0134655, 0.0133906, 0.0133164, 0.0132429, 0.01317, 0.0130978, 0.0130261, 0.0129552, 0.0128848, 0.0128151, 0.0127459, 0.0126774, 0.0126095, 0.0125421, 0.0124753, 0.0124091, 0.0123435, 0.0122785, 0.0122139, 0.01215, 0.0120866, 0.0120237, 0.0119613, 0.0118995, 0.0118382, 0.0117774, 0.0117172, 0.0116574, 0.0115981, 0.0115393, 0.011481, 0.0114232, 0.0113658, 0.011309, 0.0112526, 0.0111966, 0.0111411, 0.0110861, 0.0110315, 0.0109773, 0.0109236, 0.0108703, 0.0108174, 0.010765, 0.0107129, 0.0106613, 0.0106101, 0.0105593, 0.0105089, 0.0104589, 0.0104093, 0.0103601, 0.0103113, 0.0102628, 0.0102147, 0.010167, 0.0101196, 0.0100727, 0.010026, 0.00997977, 0.00993386, 0.00988829, 0.00984307, 0.0097982, 0.00975366, 0.00970946, 0.00966558, 0.00962204, 0.00957882, 0.00953592, 0.00949334, 0.00945108, 0.00940913, 0.00936748, 0.00932614, 0.00928511, 0.00924437, 0.00920393, 0.00916378, 0.00912393, 0.00908436, 0.00904508, 0.00900608, 0.00896736, 0.00892891, 0.00889074, 0.00885284, 0.00881521, 0.00877784, 0.00874074, 0.0087039, 0.00866731, 0.00863098, 0.00859491, 0.00855908, 0.00852351, 0.00848818, 0.00845309, 0.00841824, 0.00838364, 0.00834927, 0.00831513, 0.00828123, 0.00824755, 0.00821411, 0.00818089, 0.00814789, 0.00811512, 0.00808256, 0.00805022, 0.0080181, 0.00798619, 0.00795449, 0.007923, 0.00789171, 0.00786064, 0.00782976, 0.00779909, 0.00776862, 0.00773834, 0.00770827, 0.00767838, 0.00764869, 0.00761919, 0.00758988, 0.00756075, 0.00753181, 0.00750306, 0.00747448, 0.00744609, 0.00741788, 0.00738984, 0.00736198, 0.0073343, 0.00730679, 0.00727944, 0.00725227, 0.00722527, 0.00719843, 0.00717176, 0.00714525, 0.00711891, 0.00709272, 0.0070667, 0.00704083, 0.00701512, 0.00698956, 0.00696416, 0.00693891, 0.00691382, 0.00688887, 0.00686407, 0.00683942, 0.00681492, 0.00679056, 0.00676634, 0.00674227, 0.00671834, 0.00669455, 0.00667089, 0.00664738, 0.006624, 0.00660076, 0.00657765, 0.00655467, 0.00653183, 0.00650912, 0.00648654, 0.00646408, 0.00644176, 0.00641956, 0.00639748, 0.00637553, 0.00635371, 0.00633201, 0.00631043, 0.00628897, 0.00626762, 0.0062464, 0.0062253, 0.00620431, 0.00618344, 0.00616268, 0.00614204, 0.00612151, 0.00610109, 0.00608078, 0.00606059, 0.0060405, 0.00602052, 0.00600065, 0.00598089, 0.00596123, 0.00594168, 0.00592223, 0.00590288, 0.00588364, 0.0058645, 0.00584546, 0.00582652, 0.00580769, 0.00578895, 0.0057703, 0.00575176, 0.00573331, 0.00571496, 0.0056967, 0.00567854, 0.00566047, 0.00564249, 0.00562461, 0.00560682, 0.00558912, 0.0055715, 0.00555398, 0.00553655, 0.0055192, 0.00550195, 0.00548478, 0.00546769, 0.00545069, 0.00543378, 0.00541695, 0.0054002, 0.00538354, 0.00536696, 0.00535046, 0.00533404, 0.0053177, 0.00530145, 0.00528527, 0.00526917, 0.00525315, 0.00523721, 0.00522134, 0.00520555, 0.00518984, 0.0051742, 0.00515864, 0.00514315, 0.00512774, 0.0051124, 0.00509713, 0.00508194, 0.00506681, 0.00505176, 0.00503678, 0.00502187, 0.00500703, 0.00499226, 0.00497756, 0.00496292, 0.00494836, 0.00493386, 0.00491943, 0.00490506, 0.00489076, 0.00487653, 0.00486236, 0.00484826, 0.00483422, 0.00482024, 0.00480633, 0.00479248, 0.0047787, 0.00476497, 0.00475131, 0.00473771, 0.00472417, 0.00471069, 0.00469727, 0.00468391, 0.00467061, 0.00465737, 0.00464418, 0.00463106, 0.00461799, 0.00460498, 0.00459203, 0.00457913, 0.00456629, 0.00455351, 0.00454078, 0.00452811, 0.00451549, 0.00450293, 0.00449042, 0.00447796, 0.00446556, 0.00445321, 0.00444091, 0.00442866, 0.00441647, 0.00440433, 0.00439224, 0.0043802, 0.00436821, 0.00435628, 0.00434439, 0.00433255, 0.00432076, 0.00430903, 0.00429734, 0.00428569, 0.0042741, 0.00426256, 0.00425106, 0.00423961, 0.00422821, 0.00421685, 0.00420554, 0.00419428, 0.00418306, 0.00417189, 0.00416076, 0.00414968, 0.00413864, 0.00412765, 0.0041167, 0.0041058, 0.00409494, 0.00408412, 0.00407335, 0.00406262, 0.00405193, 0.00404129, 0.00403068, 0.00402012, 0.0040096, 0.00399913, 0.00398869, 0.00397829, 0.00396794, 0.00395762, 0.00394735, 0.00393712, 0.00392692, 0.00391677, 0.00390665, 0.00389658, 0.00388654, 0.00387654, 0.00386658, 0.00385666, 0.00384677, 0.00383693, 0.00382712, 0.00381735, 0.00380761, 0.00379792, 0.00378826, 0.00377863, 0.00376905, 0.00375949, 0.00374998, 0.0037405, 0.00373105, 0.00372165, 0.00371227, 0.00370293, 0.00369363, 0.00368436, 0.00367512, 0.00366592, 0.00365676, 0.00364762, 0.00363852, 0.00362946, 0.00362042, 0.00361142, 0.00360245, 0.00359352, 0.00358462, 0.00357575, 0.00356691, 0.00355811, 0.00354933, 0.00354059, 0.00353188, 0.0035232, 0.00351455, 0.00350593, 0.00349735, 0.00348879, 0.00348027, 0.00347177, 0.00346331, 0.00345487, 0.00344647, 0.00343809, 0.00342975, 0.00342143, 0.00341315, 0.00340489, 0.00339666, 0.00338846, 0.00338029, 0.00337214, 0.00336403, 0.00335594, 0.00334789, 0.00333985, 0.00333185, 0.00332388, 0.00331593, 0.00330801, 0.00330012, 0.00329225, 0.00328441, 0.0032766, 0.00326881, 0.00326106, 0.00325332, 0.00324562, 0.00323794, 0.00323028, 0.00322265, 0.00321505, 0.00320747, 0.00319992, 0.0031924, 0.0031849, 0.00317742, 0.00316997, 0.00316254, 0.00315514, 0.00314777, 0.00314042, 0.00313309, 0.00312579, 0.00311851, 0.00311125, 0.00310402, 0.00309681, 0.00308963, 0.00308247, 0.00307533, 0.00306822, 0.00306113, 0.00305406, 0.00304702, 0.00304, 0.003033, 0.00302603, 0.00301907, 0.00301214, 0.00300524, 0.00299835, 0.00299149, 0.00298465, 0.00297783, 0.00297103, 0.00296425, 0.0029575, 0.00295077, 0.00294406, 0.00293737, 0.0029307, 0.00292405, 0.00291743, 0.00291082, 0.00290424, 0.00289767, 0.00289113, 0.00288461, 0.00287811, 0.00287163, 0.00286516, 0.00285872, 0.0028523, 0.0028459, 0.00283952, 0.00283316, 0.00282682, 0.0028205, 0.0028142, 0.00280792, 0.00280165, 0.00279541, 0.00278919, 0.00278298, 0.00277679, 0.00277063, 0.00276448, 0.00275835, 0.00275224, 0.00274615, 0.00274008, 0.00273402, 0.00272798, 0.00272197, 0.00271597, 0.00270999, 0.00270402, 0.00269808, 0.00269215, 0.00268624, 0.00268035, 0.00267447, 0.00266862, 0.00266278, 0.00265696, 0.00265115, 0.00264537, 0.0026396, 0.00263385, 0.00262811, 0.00262239, 0.00261669, 0.00261101, 0.00260534, 0.00259969, 0.00259406, 0.00258844, 0.00258284, 0.00257726, 0.00257169, 0.00256614, 0.0025606, 0.00255508, 0.00254958, 0.00254409, 0.00253862, 0.00253317, 0.00252773, 0.00252231, 0.0025169, 0.00251151, 0.00250613, 0.00250077, 0.00249543, 0.0024901, 0.00248478, 0.00247948, 0.0024742, 0.00246893, 0.00246368, 0.00245844, 0.00245322, 0.00244801, 0.00244282, 0.00243764, 0.00243247, 0.00242733, 0.00242219, 0.00241707, 0.00241197, 0.00240688, 0.0024018, 0.00239674, 0.00239169, 0.00238666, 0.00238164, 0.00237663, 0.00237164, 0.00236666, 0.0023617, 0.00235675, 0.00235182, 0.00234689, 0.00234199, 0.00233709, 0.00233221, 0.00232734, 0.00232249, 0.00231765, 0.00231282, 0.00230801, 0.00230321, 0.00229842, 0.00229365, 0.00228889, 0.00228414, 0.00227941, 0.00227469, 0.00226998, 0.00226529, 0.0022606, 0.00225593, 0.00225128, 0.00224663, 0.002242, 0.00223738, 0.00223278, 0.00222819, 0.0022236, 0.00221904, 0.00221448, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        CHECK_ARRAY_CLOSE(rCorrect, distances,nPoints, 1e-4);
        CHECK_ARRAY_CLOSE(FSiSiCorrect, SiSiForces,nPoints, 1e-4);
        CHECK_ARRAY_CLOSE(FSiOCorrect, SiOForces,nPoints, 1e-4);
        CHECK_ARRAY_CLOSE(FOOCorrect, OOForces,nPoints, 1e-4);
    }

    TEST(USCSiO2ThreeBody) {
        Atom silicon1(AtomType::atomTypeFromAtomType(AtomTypes::Silicon));
        Atom silicon2(AtomType::atomTypeFromAtomType(AtomTypes::Silicon));
        Atom oxygen1(AtomType::atomTypeFromAtomType(AtomTypes::Oxygen));
        Atom oxygen2(AtomType::atomTypeFromAtomType(AtomTypes::Oxygen));
        vector<Atom*> atoms;
        atoms.push_back(&silicon1);
        atoms.push_back(&silicon2);
        atoms.push_back(&oxygen1);
        atoms.push_back(&oxygen2);

        USCSIO2Potential potential;
        int nPoints = 1000;
        double xMin = UnitConverter::lengthFromAngstroms(1.5);
        double xMax = xMin + UnitConverter::lengthFromAngstroms(1.0);
        double deltaX = (xMax - xMin)/(nPoints - 1);
        double theta = UnitConverter::degreesToRadians(120);

        vector<double> distances(nPoints);
        vector<double> SiOSiForces(nPoints);
        vector<double> OSiOForces(nPoints);
        for(int i=0; i<nPoints; i++) {
            double x = xMin + i*deltaX;
            distances.at(i) = x;

            // Si-O-Si
            for(Atom *atom : atoms) atom->resetForce();
            oxygen1.setPosition(0,0,0);
            silicon1.setPosition(xMin*cos(theta), xMin*sin(theta), 0);
            silicon2.setPosition(x, 0, 0);
            potential.threeParticleAction(&oxygen1, &silicon1, &silicon2);
            SiOSiForces.at(i) = silicon2.force[0];

            // O-Si-O
            for(Atom *atom : atoms) atom->resetForce();
            silicon1.setPosition(0,0,0);
            oxygen1.setPosition(xMin*cos(theta), xMin*sin(theta), 0);
            oxygen2.setPosition(x, 0, 0);
            potential.threeParticleAction(&silicon1, &oxygen1, &oxygen2);
            OSiOForces.at(i) = oxygen2.force[0];
        }

        cout << "r_ikMD = [";
        for(int i=0; i<distances.size(); i++) {
            double r = UnitConverter::lengthToAngstroms(distances.at(i));
            if(i==distances.size()-1) cout << r << "];" << endl;
            else cout << r << ", ";
        }

        cout << "F_SiOSiMD = [";
        for(int i=0; i<SiOSiForces.size(); i++) {
            double F = SiOSiForces.at(i);
            if(i==SiOSiForces.size()-1) cout << F << "];" << endl;
            else cout << F << ", ";
        }

//        cout << "F_OSiOMD = [";
//        for(int i=0; i<OSiOForces.size(); i++) {
//            double F = OSiOForces.at(i);
//            if(i==OSiOForces.size()-1) cout << F << "];" << endl;
//            else cout << F << ", ";
//        }
    }






}
